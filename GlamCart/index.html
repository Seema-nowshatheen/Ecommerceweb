<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Beauty & Fashion</title>
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: #fff0f6;
      color: #333;
    }
    header {
      background-color: #ff66b2;
      color: white;
      padding: 1rem;
      text-align: center;
      font-size: 2rem;
    }
    .products {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      padding: 2rem;
      gap: 2rem;
    }
    .product {
      background: white;
      border-radius: 10px;
      box-shadow: 0 0 10px #ffb3d9;
      width: 300px;
      text-align: center;
      padding: 1rem;
      transition: transform 0.3s;
    }
    .product:hover {
      transform: scale(1.05);
    }
    .product img {
      width: 100%;
      height: 300px;
      object-fit: cover;
      border-radius: 10px;
    }
    .product button {
      background: #ff4da6;
      color: white;
      border: none;
      padding: 0.5rem 1rem;
      border-radius: 20px;
      margin-top: 0.5rem;
      cursor: pointer;
    }
    .cart-page {
      background: #ffe6f0;
      padding: 2rem;
      margin-top: 2rem;
    }
    .cart-items {
      margin-bottom: 1rem;
    }
    .payment-section {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fff;
      padding: 2rem;
      border-radius: 10px;
      box-shadow: 0 0 20px #ff66b2;
      z-index: 1000;
    }
    .payment-section h3 {
      margin-top: 0;
      color: #cc0066;
    }
    .overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.5);
      z-index: 999;
    }
    #viewCartBtn {
      display: block;
      margin: 1rem auto;
      background-color: #cc0066;
      color: white;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 20px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>Seema's Blood Sweat & Tears</header>
  <button id="viewCartBtn" onclick="showCartPage()">View Cart</button>
  <div class="products" id="productList"></div>

  <div class="cart-page" id="cartPage" style="display: none;">
    <h2>Your Cart</h2>
    <div class="cart-items" id="cartItems"></div>
    <p><strong>Total: â‚¹<span id="total">0</span></strong></p>
    <button id="buyBtn">Buy</button>
  </div>

  <div class="overlay" id="overlay"></div>
  <div class="payment-section" id="paymentSection">
    <h3>Enter Payment Details</h3>
    <form id="paymentForm" onsubmit="return validateAndPay(event)">
      <label>Name on Card:</label>
      <input id="nameOnCard" type="text" style="width:100%;padding:0.5rem;margin:0.5rem 0;">
      <label>Card Number:</label>
      <input id="cardNumber" type="text" maxlength="16" style="width:100%;padding:0.5rem;margin:0.5rem 0;">
      <label>Expiry Date:</label>
      <input id="expiryDate" type="text" placeholder="MM/YY" maxlength="5" style="width:100%;padding:0.5rem;margin:0.5rem 0;">
      <label>CVV:</label>
      <input id="cvv" type="password" maxlength="4" style="width:100%;padding:0.5rem;margin:0.5rem 0;">
      <div style="display:flex;gap:1rem;">
        <button type="submit" style="flex:1;padding:0.5rem;background:#ff66b2;color:white;border:none;border-radius:10px;margin-top:1rem;">Pay</button>
        <button type="button" onclick="closePayment()" style="flex:1;padding:0.5rem;background:#ccc;color:#333;border:none;border-radius:10px;margin-top:1rem;">Cancel</button>
      </div>
    </form>
  </div>

  <script>
    // Cart persistence
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    const products = [
      { name: 'Lipstick', price: 299, img: 'lipstick.jpg' },
      { name: 'Eyeliner', price: 199, img: 'eyeliner.webp' },
      { name: 'Foundation', price: 499, img: 'foundation.jpg' },
      { name: 'Mascara', price: 299, img: 'maskara.jpg' },
      { name: 'Floral Dress', price: 899, img: 'floraldress.webp' },
      { name: 'Casual Top', price: 499, img: 'casual.jpeg' },
      { name: 'Palazzo Pants', price: 799, img: 'palazzo.jpg' },
      { name: 'Kurti', price: 699, img: 'kurti.webp' },
      { name: 'Blush', price: 249, img: 'blush.webp' },
      { name: 'Hair Serum', price: 349, img: 'hair.webp' },
      { name: 'Denim Jacket', price: 999, img: 'denim.webp' },
      { name: 'Nail Polish', price: 150, img: 'nail.avif' },
      { name: 'Face Wash', price: 220, img: 'fashwash.webp' },
      { name: 'Perfume', price: 799, img: 'perfume.jpg' },
      { name: 'BB Cream', price: 349, img: 'bb.webp' },
      { name: 'Silk Saree', price: 1499, img: 'saree.jpg' },
      { name: 'Jumpsuit', price: 999, img: 'jumpsuit.jpg' },
      { name: 'Crop Top', price: 399, img: 'crop.png' },
      { name: 'Maxi Dress', price: 1299, img: 'maxi.webp' },
      { name: 'Makeup Kit', price: 1999, img: 'makeup.jpeg' }
    ];

    const productList = document.getElementById('productList');
    const cartItems = document.getElementById('cartItems');
    const totalEl = document.getElementById('total');
    const buyBtn = document.getElementById('buyBtn');
    const paymentSection = document.getElementById('paymentSection');
    const overlay = document.getElementById('overlay');
    const cartPage = document.getElementById('cartPage');



    products.forEach((product, index) => {
      const div = document.createElement('div');
      div.className = 'product';
      div.innerHTML = `
        <img src="${product.img}" alt="${product.name}" />
        <h4>${product.name}</h4>
        <p>â‚¹${product.price}</p>
        <button onclick="addToCart(${index})">Add to Cart</button>
      `;
      productList.appendChild(div);
    });

    function addToCart(index) {
  const item = products[index];
  // Generate or get sessionId
  let sessionId = localStorage.getItem('sessionId');
  if (!sessionId) {
    sessionId = 'guest-' + Date.now();
    localStorage.setItem('sessionId', sessionId);
  }

  fetch('https://qejow4llb2.execute-api.eu-north-1.amazonaws.com/seem', {

    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      sessionId: sessionId,
      itemId: `${index}`,
      itemName: item.name,
      price: item.price
    })
  })
  .catch(err => {
    console.error('Error adding item to cart:', err);
  });
  cart.push(item);
  localStorage.setItem('cart', JSON.stringify(cart));
  alert(`${item.name} added to cart!`);
}


    function showCartPage() {
      cartPage.style.display = 'block';
      updateCart();
      window.scrollTo(0, document.body.scrollHeight);
    }

    function updateCart() {
      cartItems.innerHTML = '';
      let total = 0;
      cart.forEach(item => {
        const p = document.createElement('p');
        p.textContent = `${item.name} - â‚¹${item.price}`;
        cartItems.appendChild(p);
        total += item.price;
      });
      totalEl.textContent = total;
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    buyBtn.addEventListener('click', () => {
      if (cart.length > 0) {
        paymentSection.style.display = 'block';
        overlay.style.display = 'block';
      } else {
        alert('Your cart is empty!');
      }
    });

    function completePurchase() {
      alert("Payment successful! Thank you for shopping at Seema's Blood Sweat & Tears ðŸ’–");
      cart = [];
      updateCart();
      paymentSection.style.display = 'none';
      overlay.style.display = 'none';
      cartPage.style.display = 'none';
      localStorage.setItem('cart', JSON.stringify(cart));
    }

    function closePayment() {
      paymentSection.style.display = 'none';
      overlay.style.display = 'none';
    }

    function validateAndPay(event) {
      event.preventDefault();
      const name = document.getElementById('nameOnCard').value.trim();
      const card = document.getElementById('cardNumber').value.trim();
      const expiry = document.getElementById('expiryDate').value.trim();
      const cvv = document.getElementById('cvv').value.trim();
      if (!name || !card || !expiry || !cvv) {
        alert('Please fill all payment details.');
        return false;
      }
      if (!/^\d{16}$/.test(card)) {
        alert('Card number must be 16 digits.');
        return false;
      }
      if (!/^\d{2}\/\d{2}$/.test(expiry)) {
        alert('Expiry must be in MM/YY format.');
        return false;
      }
      if (!/^\d{3,4}$/.test(cvv)) {
        alert('CVV must be 3 or 4 digits.');
        return false;
      }
      completePurchase();
      return false;
    }
  </script>
</body>
</html>
